{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9e3bd222",
   "metadata": {
    "_execution_state": "idle",
    "_uuid": "051d70d956493feee0c6d64651c6a088724dca2a",
    "execution": {
     "iopub.execute_input": "2022-04-26T23:18:06.759390Z",
     "iopub.status.busy": "2022-04-26T23:18:06.757486Z",
     "iopub.status.idle": "2022-04-26T23:18:10.253811Z",
     "shell.execute_reply": "2022-04-26T23:18:10.252064Z"
    },
    "papermill": {
     "duration": 3.503389,
     "end_time": "2022-04-26T23:18:10.256091",
     "exception": false,
     "start_time": "2022-04-26T23:18:06.752702",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "── \u001b[1mAttaching packages\u001b[22m ─────────────────────────────────────── tidyverse 1.3.1 ──\n",
      "\n",
      "\u001b[32m✔\u001b[39m \u001b[34mggplot2\u001b[39m 3.3.5     \u001b[32m✔\u001b[39m \u001b[34mpurrr  \u001b[39m 0.3.4\n",
      "\u001b[32m✔\u001b[39m \u001b[34mtibble \u001b[39m 3.1.6     \u001b[32m✔\u001b[39m \u001b[34mdplyr  \u001b[39m 1.0.8\n",
      "\u001b[32m✔\u001b[39m \u001b[34mtidyr  \u001b[39m 1.2.0     \u001b[32m✔\u001b[39m \u001b[34mstringr\u001b[39m 1.4.0\n",
      "\u001b[32m✔\u001b[39m \u001b[34mreadr  \u001b[39m 2.1.2     \u001b[32m✔\u001b[39m \u001b[34mforcats\u001b[39m 0.5.1\n",
      "\n",
      "── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n",
      "\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m masks \u001b[34mstats\u001b[39m::filter()\n",
      "\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m    masks \u001b[34mstats\u001b[39m::lag()\n",
      "\n",
      "Loading required package: lattice\n",
      "\n",
      "\n",
      "Attaching package: ‘caret’\n",
      "\n",
      "\n",
      "The following object is masked from ‘package:purrr’:\n",
      "\n",
      "    lift\n",
      "\n",
      "\n",
      "The following object is masked from ‘package:httr’:\n",
      "\n",
      "    progress\n",
      "\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "'heart-disease-dataset'"
      ],
      "text/latex": [
       "'heart-disease-dataset'"
      ],
      "text/markdown": [
       "'heart-disease-dataset'"
      ],
      "text/plain": [
       "[1] \"heart-disease-dataset\""
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "library(tidyverse) # metapackage of all tidyverse packages\n",
    "library(caret)\n",
    "list.files(path = \"../input\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "75b0a59f",
   "metadata": {
    "papermill": {
     "duration": 0.002698,
     "end_time": "2022-04-26T23:18:10.261994",
     "exception": false,
     "start_time": "2022-04-26T23:18:10.259296",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "**Support Vector Machine - SVM**\n",
    "\n",
    "To sum up, SVM is used to classify data by using a hyperplan, such that the distance between the hyperplan and the support vectors is maximum\n",
    "\n",
    "![alt text for screen readers](https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2019/01/How-does-SVM-work3-SVM-Tutorial-768x424.png \"Text to show on mouseover\")\n",
    "\n",
    "\n",
    "* Liniear SVM\n",
    "\n",
    "![alt text for screen readers](https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2019/01/How-does-SVM-work-new-data-point-SVM-Tutorial-768x416.png \"Text to show on mouseover\")\n",
    "\n",
    "Try this!\n",
    "\n",
    "![alt text for screen readers](https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2019/01/How-does-SVM-work4-SVM-Tutorial-768x416.png \"Text to show on mouseover\")\n",
    "\n",
    "Choose this with the margin is maximum for this hyperplane!\n",
    "\n",
    "\n",
    "![alt text for screen readers](https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2019/01/How-does-SVM-work5-SVM-Tutorial-768x416.png \"Text to show on mouseover\")\n",
    "\n",
    "* Non-Liniear SVM\n",
    "\n",
    "![alt text for screen readers](https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2019/01/Non-linear-SVM-SVM-Tutorial-768x526.png \"Text to show on mouseover\")\n",
    "\n",
    "Can't draw a hyperlane like this!\n",
    "\n",
    "![alt text for screen readers](https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2019/01/Non-linear-SVM1-SVM-Tutorial-768x481.png \"Text to show on mouseover\")\n",
    "\n",
    "Having to transform the 2D space into a 3D space to see a dividing margin between the 2 classes of data.\n",
    "![alt text for screen readers](https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2019/01/Non-linear-SVM2-SVM-Tutorial.png \"Text to show on mouseover\")\n",
    "\n",
    "3 features of SVM:\n",
    "1. A supervised learning algorithm <=> SVM trains on a set of labeled data. SVM studies the labeled training data and then classifies any new input data depending on what it learned in the training phase\n",
    "2. Main advantage: used for both classification (SVM) and regression problems (SVR - Support Vector Regressor)\n",
    "3. Used for classifying non-linear data by using the kernel trick. \n",
    "\n",
    "The kernel trick: transforming data into another dimension that has a clear dividing margin between classes of data. After which you can easily draw a hyperplane between the various classes of data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "286b45a2",
   "metadata": {
    "papermill": {
     "duration": 0.00263,
     "end_time": "2022-04-26T23:18:10.267658",
     "exception": false,
     "start_time": "2022-04-26T23:18:10.265028",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Ref: https://www.edureka.co/blog/support-vector-machine-in-r/\n",
    "\n",
    "**Problem**: to study a heart disease data set and to model a classifier for predicting whether a patient is suffering from any heart disease or not.\n",
    "\n",
    "**Steps**:\n",
    "1. load dataset\n",
    "2. data splicing - split data into training set and testing set\n",
    "3. data cleaning - deal with any missing values or inconsistent values before building the training model\n",
    "4. model training\n",
    "5. model accuracy\n",
    "6. building and tuning of an SVM classifier with different values of C\n",
    "7. conclusion"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "7c412ca6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-26T23:18:10.308593Z",
     "iopub.status.busy": "2022-04-26T23:18:10.274924Z",
     "iopub.status.idle": "2022-04-26T23:18:10.383734Z",
     "shell.execute_reply": "2022-04-26T23:18:10.381942Z"
    },
    "papermill": {
     "duration": 0.116031,
     "end_time": "2022-04-26T23:18:10.386416",
     "exception": false,
     "start_time": "2022-04-26T23:18:10.270385",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'data.frame':\t1025 obs. of  14 variables:\n",
      " $ age     : int  52 53 70 61 62 58 58 55 46 54 ...\n",
      " $ sex     : int  1 1 1 1 0 0 1 1 1 1 ...\n",
      " $ cp      : int  0 0 0 0 0 0 0 0 0 0 ...\n",
      " $ trestbps: int  125 140 145 148 138 100 114 160 120 122 ...\n",
      " $ chol    : int  212 203 174 203 294 248 318 289 249 286 ...\n",
      " $ fbs     : int  0 1 0 0 1 0 0 0 0 0 ...\n",
      " $ restecg : int  1 0 1 1 1 0 2 0 0 0 ...\n",
      " $ thalach : int  168 155 125 161 106 122 140 145 144 116 ...\n",
      " $ exang   : int  0 1 1 0 0 0 0 1 0 1 ...\n",
      " $ oldpeak : num  1 3.1 2.6 0 1.9 1 4.4 0.8 0.8 3.2 ...\n",
      " $ slope   : int  2 0 0 2 1 1 0 1 2 1 ...\n",
      " $ ca      : int  2 0 0 1 3 0 3 1 0 2 ...\n",
      " $ thal    : int  3 3 3 3 2 2 1 3 3 2 ...\n",
      " $ target  : int  0 0 0 0 0 1 0 0 0 0 ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 14</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>age</th><th scope=col>sex</th><th scope=col>cp</th><th scope=col>trestbps</th><th scope=col>chol</th><th scope=col>fbs</th><th scope=col>restecg</th><th scope=col>thalach</th><th scope=col>exang</th><th scope=col>oldpeak</th><th scope=col>slope</th><th scope=col>ca</th><th scope=col>thal</th><th scope=col>target</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>52</td><td>1</td><td>0</td><td>125</td><td>212</td><td>0</td><td>1</td><td>168</td><td>0</td><td>1.0</td><td>2</td><td>2</td><td>3</td><td>0</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>53</td><td>1</td><td>0</td><td>140</td><td>203</td><td>1</td><td>0</td><td>155</td><td>1</td><td>3.1</td><td>0</td><td>0</td><td>3</td><td>0</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>70</td><td>1</td><td>0</td><td>145</td><td>174</td><td>0</td><td>1</td><td>125</td><td>1</td><td>2.6</td><td>0</td><td>0</td><td>3</td><td>0</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>61</td><td>1</td><td>0</td><td>148</td><td>203</td><td>0</td><td>1</td><td>161</td><td>0</td><td>0.0</td><td>2</td><td>1</td><td>3</td><td>0</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>62</td><td>0</td><td>0</td><td>138</td><td>294</td><td>1</td><td>1</td><td>106</td><td>0</td><td>1.9</td><td>1</td><td>3</td><td>2</td><td>0</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>58</td><td>0</td><td>0</td><td>100</td><td>248</td><td>0</td><td>0</td><td>122</td><td>0</td><td>1.0</td><td>1</td><td>0</td><td>2</td><td>1</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 14\n",
       "\\begin{tabular}{r|llllllllllllll}\n",
       "  & age & sex & cp & trestbps & chol & fbs & restecg & thalach & exang & oldpeak & slope & ca & thal & target\\\\\n",
       "  & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <dbl> & <int> & <int> & <int> & <int>\\\\\n",
       "\\hline\n",
       "\t1 & 52 & 1 & 0 & 125 & 212 & 0 & 1 & 168 & 0 & 1.0 & 2 & 2 & 3 & 0\\\\\n",
       "\t2 & 53 & 1 & 0 & 140 & 203 & 1 & 0 & 155 & 1 & 3.1 & 0 & 0 & 3 & 0\\\\\n",
       "\t3 & 70 & 1 & 0 & 145 & 174 & 0 & 1 & 125 & 1 & 2.6 & 0 & 0 & 3 & 0\\\\\n",
       "\t4 & 61 & 1 & 0 & 148 & 203 & 0 & 1 & 161 & 0 & 0.0 & 2 & 1 & 3 & 0\\\\\n",
       "\t5 & 62 & 0 & 0 & 138 & 294 & 1 & 1 & 106 & 0 & 1.9 & 1 & 3 & 2 & 0\\\\\n",
       "\t6 & 58 & 0 & 0 & 100 & 248 & 0 & 0 & 122 & 0 & 1.0 & 1 & 0 & 2 & 1\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 14\n",
       "\n",
       "| <!--/--> | age &lt;int&gt; | sex &lt;int&gt; | cp &lt;int&gt; | trestbps &lt;int&gt; | chol &lt;int&gt; | fbs &lt;int&gt; | restecg &lt;int&gt; | thalach &lt;int&gt; | exang &lt;int&gt; | oldpeak &lt;dbl&gt; | slope &lt;int&gt; | ca &lt;int&gt; | thal &lt;int&gt; | target &lt;int&gt; |\n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| 1 | 52 | 1 | 0 | 125 | 212 | 0 | 1 | 168 | 0 | 1.0 | 2 | 2 | 3 | 0 |\n",
       "| 2 | 53 | 1 | 0 | 140 | 203 | 1 | 0 | 155 | 1 | 3.1 | 0 | 0 | 3 | 0 |\n",
       "| 3 | 70 | 1 | 0 | 145 | 174 | 0 | 1 | 125 | 1 | 2.6 | 0 | 0 | 3 | 0 |\n",
       "| 4 | 61 | 1 | 0 | 148 | 203 | 0 | 1 | 161 | 0 | 0.0 | 2 | 1 | 3 | 0 |\n",
       "| 5 | 62 | 0 | 0 | 138 | 294 | 1 | 1 | 106 | 0 | 1.9 | 1 | 3 | 2 | 0 |\n",
       "| 6 | 58 | 0 | 0 | 100 | 248 | 0 | 0 | 122 | 0 | 1.0 | 1 | 0 | 2 | 1 |\n",
       "\n"
      ],
      "text/plain": [
       "  age sex cp trestbps chol fbs restecg thalach exang oldpeak slope ca thal\n",
       "1 52  1   0  125      212  0   1       168     0     1.0     2     2  3   \n",
       "2 53  1   0  140      203  1   0       155     1     3.1     0     0  3   \n",
       "3 70  1   0  145      174  0   1       125     1     2.6     0     0  3   \n",
       "4 61  1   0  148      203  0   1       161     0     0.0     2     1  3   \n",
       "5 62  0   0  138      294  1   1       106     0     1.9     1     3  2   \n",
       "6 58  0   0  100      248  0   0       122     0     1.0     1     0  2   \n",
       "  target\n",
       "1 0     \n",
       "2 0     \n",
       "3 0     \n",
       "4 0     \n",
       "5 0     \n",
       "6 1     "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# step 1 - load dataset\n",
    "heart <- read.csv(\"../input/heart-disease-dataset/heart.csv\", sep = ',', header = TRUE)\n",
    "\n",
    "str(heart)\n",
    "head(heart)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "006ee176",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-26T23:18:10.395155Z",
     "iopub.status.busy": "2022-04-26T23:18:10.393729Z",
     "iopub.status.idle": "2022-04-26T23:18:10.430019Z",
     "shell.execute_reply": "2022-04-26T23:18:10.428163Z"
    },
    "papermill": {
     "duration": 0.042763,
     "end_time": "2022-04-26T23:18:10.432235",
     "exception": false,
     "start_time": "2022-04-26T23:18:10.389472",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".list-inline {list-style: none; margin:0; padding: 0}\n",
       ".list-inline>li {display: inline-block}\n",
       ".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n",
       "</style>\n",
       "<ol class=list-inline><li>718</li><li>14</li></ol>\n"
      ],
      "text/latex": [
       "\\begin{enumerate*}\n",
       "\\item 718\n",
       "\\item 14\n",
       "\\end{enumerate*}\n"
      ],
      "text/markdown": [
       "1. 718\n",
       "2. 14\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "[1] 718  14"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".list-inline {list-style: none; margin:0; padding: 0}\n",
       ".list-inline>li {display: inline-block}\n",
       ".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n",
       "</style>\n",
       "<ol class=list-inline><li>307</li><li>14</li></ol>\n"
      ],
      "text/latex": [
       "\\begin{enumerate*}\n",
       "\\item 307\n",
       "\\item 14\n",
       "\\end{enumerate*}\n"
      ],
      "text/markdown": [
       "1. 307\n",
       "2. 14\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "[1] 307  14"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# step 2 - data splicing\n",
    "\n",
    "# partitioning our data into train and test set\n",
    "intrain <- createDataPartition(y = heart$target, p = 0.7, list = FALSE) # 'list': whether to return a list or matrix\n",
    "\n",
    "training <- heart[intrain, ]\n",
    "testing <- heart[-intrain, ]\n",
    "\n",
    "# checking dimensions\n",
    "dim(training)\n",
    "dim(testing)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "514b8d76",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-26T23:18:10.441778Z",
     "iopub.status.busy": "2022-04-26T23:18:10.440287Z",
     "iopub.status.idle": "2022-04-26T23:18:10.473794Z",
     "shell.execute_reply": "2022-04-26T23:18:10.472007Z"
    },
    "papermill": {
     "duration": 0.040893,
     "end_time": "2022-04-26T23:18:10.476535",
     "exception": false,
     "start_time": "2022-04-26T23:18:10.435642",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "FALSE"
      ],
      "text/latex": [
       "FALSE"
      ],
      "text/markdown": [
       "FALSE"
      ],
      "text/plain": [
       "[1] FALSE"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "      age             sex               cp            trestbps    \n",
       " Min.   :29.00   Min.   :0.0000   Min.   :0.0000   Min.   : 94.0  \n",
       " 1st Qu.:48.00   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:120.0  \n",
       " Median :56.00   Median :1.0000   Median :1.0000   Median :130.0  \n",
       " Mean   :54.43   Mean   :0.6956   Mean   :0.9424   Mean   :131.6  \n",
       " 3rd Qu.:61.00   3rd Qu.:1.0000   3rd Qu.:2.0000   3rd Qu.:140.0  \n",
       " Max.   :77.00   Max.   :1.0000   Max.   :3.0000   Max.   :200.0  \n",
       "      chol          fbs            restecg          thalach     \n",
       " Min.   :126   Min.   :0.0000   Min.   :0.0000   Min.   : 71.0  \n",
       " 1st Qu.:211   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:132.0  \n",
       " Median :240   Median :0.0000   Median :1.0000   Median :152.0  \n",
       " Mean   :246   Mean   :0.1493   Mean   :0.5298   Mean   :149.1  \n",
       " 3rd Qu.:275   3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:166.0  \n",
       " Max.   :564   Max.   :1.0000   Max.   :2.0000   Max.   :202.0  \n",
       "     exang           oldpeak          slope             ca        \n",
       " Min.   :0.0000   Min.   :0.000   Min.   :0.000   Min.   :0.0000  \n",
       " 1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:1.000   1st Qu.:0.0000  \n",
       " Median :0.0000   Median :0.800   Median :1.000   Median :0.0000  \n",
       " Mean   :0.3366   Mean   :1.072   Mean   :1.385   Mean   :0.7541  \n",
       " 3rd Qu.:1.0000   3rd Qu.:1.800   3rd Qu.:2.000   3rd Qu.:1.0000  \n",
       " Max.   :1.0000   Max.   :6.200   Max.   :2.000   Max.   :4.0000  \n",
       "      thal           target      \n",
       " Min.   :0.000   Min.   :0.0000  \n",
       " 1st Qu.:2.000   1st Qu.:0.0000  \n",
       " Median :2.000   Median :1.0000  \n",
       " Mean   :2.324   Mean   :0.5132  \n",
       " 3rd Qu.:3.000   3rd Qu.:1.0000  \n",
       " Max.   :3.000   Max.   :1.0000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# step 3 - data cleaning\n",
    "\n",
    "# checking for any null values\n",
    "anyNA(heart) # FALSE: no missing values\n",
    "\n",
    "summary(heart) # values of the various variables are not standardized\n",
    "\n",
    "# 'target': target variable; should be a categorical variable\n",
    "# to convert to the categorical variable, we need to factorize it!\n",
    "training[[\"target\"]] = factor(training[[\"target\"]])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "a39efaf1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-26T23:18:10.486511Z",
     "iopub.status.busy": "2022-04-26T23:18:10.485045Z",
     "iopub.status.idle": "2022-04-26T23:18:13.623226Z",
     "shell.execute_reply": "2022-04-26T23:18:13.620236Z"
    },
    "papermill": {
     "duration": 3.14679,
     "end_time": "2022-04-26T23:18:13.626834",
     "exception": false,
     "start_time": "2022-04-26T23:18:10.480044",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Support Vector Machines with Linear Kernel \n",
       "\n",
       "718 samples\n",
       " 13 predictor\n",
       "  2 classes: '0', '1' \n",
       "\n",
       "Pre-processing: centered (13), scaled (13) \n",
       "Resampling: Cross-Validated (10 fold, repeated 3 times) \n",
       "Summary of sample sizes: 647, 646, 645, 646, 646, 646, ... \n",
       "Resampling results:\n",
       "\n",
       "  Accuracy   Kappa    \n",
       "  0.8272885  0.6526587\n",
       "\n",
       "Tuning parameter 'C' was held constant at a value of 1"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# step 4 - model training\n",
    "\n",
    "# first, implementing the trainControl() method \n",
    "# to control all the computational overheads\n",
    "trainCtrl <- trainControl(\n",
    "    method = \"repeatedcv\",    # the repeated cross-validation method\n",
    "    number = 10,              # the number of resampling iterations \n",
    "    repeats = 3               # the sets to compute for our repeated cross-validation\n",
    ")\n",
    "\n",
    "svm_linear <- train(\n",
    "    target ~ .,                        # all attributes in our classifier and 'target' as the target variable\n",
    "    data = training, \n",
    "    method = \"svmLinear\",\n",
    "    trControl = trainCtrl,\n",
    "    preProcess = c(\"center\", \"scale\"), # pre-processing for centering and scaling our training data to mean ~ \"0\", standard deviation = \"1\"\n",
    "    tuneLength = 10                    # tuning our algorithm\n",
    ")\n",
    "\n",
    "# check the result\n",
    "svm_linear     # a linear model which is trained with C = 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "fa261bc2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-26T23:18:13.645653Z",
     "iopub.status.busy": "2022-04-26T23:18:13.643021Z",
     "iopub.status.idle": "2022-04-26T23:18:13.690068Z",
     "shell.execute_reply": "2022-04-26T23:18:13.686974Z"
    },
    "papermill": {
     "duration": 0.059805,
     "end_time": "2022-04-26T23:18:13.693740",
     "exception": false,
     "start_time": "2022-04-26T23:18:13.633935",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".list-inline {list-style: none; margin:0; padding: 0}\n",
       ".list-inline>li {display: inline-block}\n",
       ".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n",
       "</style>\n",
       "<ol class=list-inline><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>1</li><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>0</li><li>1</li><li>0</li><li>1</li><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>0</li><li>1</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>0</li><li>1</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>0</li><li>0</li><li>1</li><li>1</li><li>0</li><li>1</li><li>0</li><li>0</li><li>0</li><li>1</li><li>1</li><li>1</li><li>1</li><li>1</li><li>0</li></ol>\n",
       "\n",
       "<details>\n",
       "\t<summary style=display:list-item;cursor:pointer>\n",
       "\t\t<strong>Levels</strong>:\n",
       "\t</summary>\n",
       "\t<style>\n",
       "\t.list-inline {list-style: none; margin:0; padding: 0}\n",
       "\t.list-inline>li {display: inline-block}\n",
       "\t.list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n",
       "\t</style>\n",
       "\t<ol class=list-inline><li>'0'</li><li>'1'</li></ol>\n",
       "</details>"
      ],
      "text/latex": [
       "\\begin{enumerate*}\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 0\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 1\n",
       "\\item 0\n",
       "\\end{enumerate*}\n",
       "\n",
       "\\emph{Levels}: \\begin{enumerate*}\n",
       "\\item '0'\n",
       "\\item '1'\n",
       "\\end{enumerate*}\n"
      ],
      "text/markdown": [
       "1. 0\n",
       "2. 0\n",
       "3. 1\n",
       "4. 0\n",
       "5. 1\n",
       "6. 0\n",
       "7. 1\n",
       "8. 1\n",
       "9. 0\n",
       "10. 1\n",
       "11. 0\n",
       "12. 0\n",
       "13. 1\n",
       "14. 1\n",
       "15. 0\n",
       "16. 1\n",
       "17. 1\n",
       "18. 1\n",
       "19. 0\n",
       "20. 0\n",
       "21. 1\n",
       "22. 1\n",
       "23. 0\n",
       "24. 1\n",
       "25. 0\n",
       "26. 0\n",
       "27. 0\n",
       "28. 0\n",
       "29. 1\n",
       "30. 0\n",
       "31. 1\n",
       "32. 0\n",
       "33. 0\n",
       "34. 1\n",
       "35. 1\n",
       "36. 0\n",
       "37. 1\n",
       "38. 1\n",
       "39. 0\n",
       "40. 0\n",
       "41. 0\n",
       "42. 0\n",
       "43. 0\n",
       "44. 1\n",
       "45. 1\n",
       "46. 0\n",
       "47. 1\n",
       "48. 1\n",
       "49. 1\n",
       "50. 0\n",
       "51. 1\n",
       "52. 1\n",
       "53. 0\n",
       "54. 1\n",
       "55. 0\n",
       "56. 0\n",
       "57. 1\n",
       "58. 1\n",
       "59. 0\n",
       "60. 0\n",
       "61. 1\n",
       "62. 1\n",
       "63. 1\n",
       "64. 1\n",
       "65. 1\n",
       "66. 0\n",
       "67. 0\n",
       "68. 1\n",
       "69. 1\n",
       "70. 1\n",
       "71. 0\n",
       "72. 1\n",
       "73. 0\n",
       "74. 0\n",
       "75. 1\n",
       "76. 0\n",
       "77. 1\n",
       "78. 1\n",
       "79. 0\n",
       "80. 0\n",
       "81. 1\n",
       "82. 1\n",
       "83. 1\n",
       "84. 0\n",
       "85. 0\n",
       "86. 1\n",
       "87. 0\n",
       "88. 0\n",
       "89. 1\n",
       "90. 0\n",
       "91. 1\n",
       "92. 1\n",
       "93. 1\n",
       "94. 0\n",
       "95. 0\n",
       "96. 0\n",
       "97. 0\n",
       "98. 1\n",
       "99. 0\n",
       "100. 0\n",
       "101. 1\n",
       "102. 1\n",
       "103. 1\n",
       "104. 0\n",
       "105. 1\n",
       "106. 1\n",
       "107. 0\n",
       "108. 1\n",
       "109. 0\n",
       "110. 1\n",
       "111. 1\n",
       "112. 0\n",
       "113. 1\n",
       "114. 0\n",
       "115. 0\n",
       "116. 0\n",
       "117. 0\n",
       "118. 0\n",
       "119. 0\n",
       "120. 0\n",
       "121. 1\n",
       "122. 1\n",
       "123. 0\n",
       "124. 0\n",
       "125. 0\n",
       "126. 1\n",
       "127. 1\n",
       "128. 1\n",
       "129. 1\n",
       "130. 1\n",
       "131. 1\n",
       "132. 1\n",
       "133. 1\n",
       "134. 1\n",
       "135. 0\n",
       "136. 1\n",
       "137. 1\n",
       "138. 0\n",
       "139. 1\n",
       "140. 1\n",
       "141. 1\n",
       "142. 1\n",
       "143. 1\n",
       "144. 1\n",
       "145. 1\n",
       "146. 1\n",
       "147. 0\n",
       "148. 1\n",
       "149. 1\n",
       "150. 0\n",
       "151. 0\n",
       "152. 0\n",
       "153. 0\n",
       "154. 0\n",
       "155. 1\n",
       "156. 0\n",
       "157. 0\n",
       "158. 1\n",
       "159. 0\n",
       "160. 1\n",
       "161. 1\n",
       "162. 1\n",
       "163. 0\n",
       "164. 1\n",
       "165. 1\n",
       "166. 0\n",
       "167. 1\n",
       "168. 1\n",
       "169. 1\n",
       "170. 0\n",
       "171. 0\n",
       "172. 0\n",
       "173. 0\n",
       "174. 0\n",
       "175. 1\n",
       "176. 1\n",
       "177. 1\n",
       "178. 0\n",
       "179. 0\n",
       "180. 0\n",
       "181. 0\n",
       "182. 1\n",
       "183. 0\n",
       "184. 0\n",
       "185. 0\n",
       "186. 1\n",
       "187. 1\n",
       "188. 0\n",
       "189. 1\n",
       "190. 1\n",
       "191. 0\n",
       "192. 1\n",
       "193. 1\n",
       "194. 1\n",
       "195. 1\n",
       "196. 1\n",
       "197. 0\n",
       "198. 0\n",
       "199. 1\n",
       "200. 0\n",
       "201. 1\n",
       "202. 0\n",
       "203. 1\n",
       "204. 0\n",
       "205. 1\n",
       "206. 0\n",
       "207. 0\n",
       "208. 1\n",
       "209. 0\n",
       "210. 1\n",
       "211. 1\n",
       "212. 1\n",
       "213. 1\n",
       "214. 1\n",
       "215. 1\n",
       "216. 0\n",
       "217. 1\n",
       "218. 0\n",
       "219. 1\n",
       "220. 1\n",
       "221. 0\n",
       "222. 0\n",
       "223. 0\n",
       "224. 1\n",
       "225. 1\n",
       "226. 1\n",
       "227. 0\n",
       "228. 1\n",
       "229. 1\n",
       "230. 0\n",
       "231. 0\n",
       "232. 0\n",
       "233. 0\n",
       "234. 0\n",
       "235. 0\n",
       "236. 0\n",
       "237. 1\n",
       "238. 0\n",
       "239. 1\n",
       "240. 1\n",
       "241. 1\n",
       "242. 1\n",
       "243. 1\n",
       "244. 1\n",
       "245. 0\n",
       "246. 1\n",
       "247. 1\n",
       "248. 1\n",
       "249. 1\n",
       "250. 0\n",
       "251. 0\n",
       "252. 0\n",
       "253. 1\n",
       "254. 1\n",
       "255. 1\n",
       "256. 1\n",
       "257. 0\n",
       "258. 1\n",
       "259. 1\n",
       "260. 1\n",
       "261. 1\n",
       "262. 1\n",
       "263. 1\n",
       "264. 1\n",
       "265. 0\n",
       "266. 0\n",
       "267. 0\n",
       "268. 0\n",
       "269. 0\n",
       "270. 0\n",
       "271. 0\n",
       "272. 0\n",
       "273. 0\n",
       "274. 0\n",
       "275. 1\n",
       "276. 0\n",
       "277. 1\n",
       "278. 1\n",
       "279. 0\n",
       "280. 0\n",
       "281. 0\n",
       "282. 1\n",
       "283. 0\n",
       "284. 0\n",
       "285. 0\n",
       "286. 1\n",
       "287. 1\n",
       "288. 0\n",
       "289. 0\n",
       "290. 1\n",
       "291. 1\n",
       "292. 1\n",
       "293. 0\n",
       "294. 0\n",
       "295. 1\n",
       "296. 1\n",
       "297. 0\n",
       "298. 1\n",
       "299. 0\n",
       "300. 0\n",
       "301. 0\n",
       "302. 1\n",
       "303. 1\n",
       "304. 1\n",
       "305. 1\n",
       "306. 1\n",
       "307. 0\n",
       "\n",
       "\n",
       "\n",
       "**Levels**: 1. '0'\n",
       "2. '1'\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "  [1] 0 0 1 0 1 0 1 1 0 1 0 0 1 1 0 1 1 1 0 0 1 1 0 1 0 0 0 0 1 0 1 0 0 1 1 0 1\n",
       " [38] 1 0 0 0 0 0 1 1 0 1 1 1 0 1 1 0 1 0 0 1 1 0 0 1 1 1 1 1 0 0 1 1 1 0 1 0 0\n",
       " [75] 1 0 1 1 0 0 1 1 1 0 0 1 0 0 1 0 1 1 1 0 0 0 0 1 0 0 1 1 1 0 1 1 0 1 0 1 1\n",
       "[112] 0 1 0 0 0 0 0 0 0 1 1 0 0 0 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 0 1\n",
       "[149] 1 0 0 0 0 0 1 0 0 1 0 1 1 1 0 1 1 0 1 1 1 0 0 0 0 0 1 1 1 0 0 0 0 1 0 0 0\n",
       "[186] 1 1 0 1 1 0 1 1 1 1 1 0 0 1 0 1 0 1 0 1 0 0 1 0 1 1 1 1 1 1 0 1 0 1 1 0 0\n",
       "[223] 0 1 1 1 0 1 1 0 0 0 0 0 0 0 1 0 1 1 1 1 1 1 0 1 1 1 1 0 0 0 1 1 1 1 0 1 1\n",
       "[260] 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 0 1 1 0 0 0 1 0 0 0 1 1 0 0 1 1 1 0 0 1 1\n",
       "[297] 0 1 0 0 0 1 1 1 1 1 0\n",
       "Levels: 0 1"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# predict classes for our test set\n",
    "test_pred <- predict(svm_linear, newdata = testing)\n",
    "test_pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a7ac2a63",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-26T23:18:13.714651Z",
     "iopub.status.busy": "2022-04-26T23:18:13.711878Z",
     "iopub.status.idle": "2022-04-26T23:18:13.741062Z",
     "shell.execute_reply": "2022-04-26T23:18:13.739424Z"
    },
    "papermill": {
     "duration": 0.042107,
     "end_time": "2022-04-26T23:18:13.743788",
     "exception": false,
     "start_time": "2022-04-26T23:18:13.701681",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Confusion Matrix and Statistics\n",
       "\n",
       "         \n",
       "test_pred   0   1\n",
       "        0 123  21\n",
       "        1  29 134\n",
       "                                         \n",
       "               Accuracy : 0.8371         \n",
       "                 95% CI : (0.791, 0.8766)\n",
       "    No Information Rate : 0.5049         \n",
       "    P-Value [Acc > NIR] : <2e-16         \n",
       "                                         \n",
       "                  Kappa : 0.6741         \n",
       "                                         \n",
       " Mcnemar's Test P-Value : 0.3222         \n",
       "                                         \n",
       "            Sensitivity : 0.8092         \n",
       "            Specificity : 0.8645         \n",
       "         Pos Pred Value : 0.8542         \n",
       "         Neg Pred Value : 0.8221         \n",
       "             Prevalence : 0.4951         \n",
       "         Detection Rate : 0.4007         \n",
       "   Detection Prevalence : 0.4691         \n",
       "      Balanced Accuracy : 0.8369         \n",
       "                                         \n",
       "       'Positive' Class : 0              \n",
       "                                         "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# step 5 - model accuracy \n",
    "# checking the accuracy of our model\n",
    "confusionMatrix(\n",
    "    table(\n",
    "        test_pred, testing$target\n",
    "    )\n",
    ")\n",
    "# Our model accuracy for test set = 89.9%"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3f60a859",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-04-26T23:18:13.755021Z",
     "iopub.status.busy": "2022-04-26T23:18:13.753567Z",
     "iopub.status.idle": "2022-04-26T23:18:13.764738Z",
     "shell.execute_reply": "2022-04-26T23:18:13.763157Z"
    },
    "papermill": {
     "duration": 0.01909,
     "end_time": "2022-04-26T23:18:13.766925",
     "exception": false,
     "start_time": "2022-04-26T23:18:13.747835",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# step 6 - build svmLinear classifier with different values of C\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.0.5"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 10.581337,
   "end_time": "2022-04-26T23:18:13.891571",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2022-04-26T23:18:03.310234",
   "version": "2.3.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
